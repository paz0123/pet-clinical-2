<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Invoice - Pet Clinic</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/responsive.css') }}">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="logo">üêæ Pet Clinic</div>
            <div class="nav-right">
                <span class="user-badge">
                    Staff: <strong>{{ user_name or 'Clinic Staff' }}</strong>
                </span>
                <a href="{{ url_for('staff_dashboard') }}" class="btn-back">‚Üê Back to Dashboard</a>
            </div>
        </div>
    </nav>

    <main class="container auth-container">
        <div class="auth-box">
            <h1>Create Invoice</h1>
            <p class="auth-subtitle">
                Generate an invoice for this visit.
            </p>

            <div class="alert">
                <strong>Pet:</strong> {{ appointment.pet_name }}<br>
                <strong>Owner:</strong> {{ appointment.owner_name }}<br>
                <strong>Appointment:</strong> {{ appointment.appointment_date }} at {{ appointment.appointment_time }}
            </div>

            <div id="errorMessage" class="alert alert-danger {% if not error_message %}hidden{% endif %}">
                {{ error_message or "" }}
            </div>
            <div id="successMessage" class="alert alert-success {% if not success_message %}hidden{% endif %}">
                {{ success_message or "" }}
            </div>

            <form method="post" class="auth-form"
                  action="{{ url_for('create_invoice', appointment_id=appointment.id) }}">
                <div class="form-group">
                    <label for="total_amount">Total Amount</label>
                    <input
                        type="number"
                        step="0.01"
                        id="total_amount"
                        name="total_amount"
                        required
                        placeholder="e.g., 45.00"
                        value="{{ form_data.get('total_amount','') if form_data else '' }}"
                    >
                    <span class="form-error">
                        {{ errors.get('total_amount','') if errors is defined else '' }}
                    </span>
                </div>

                <div class="form-group">
                    <label for="status">Status</label>
                    <select id="status" name="status" required>
                        <option value="unpaid" {% if form_data.get('status') == 'unpaid' %}selected{% endif %}>Unpaid</option>
                        <option value="paid" {% if form_data.get('status') == 'paid' %}selected{% endif %}>Paid</option>
                        <option value="cancelled" {% if form_data.get('status') == 'cancelled' %}selected{% endif %}>Cancelled</option>
                    </select>
                    <span class="form-error">
                        {{ errors.get('status','') if errors is defined else '' }}
                    </span>
                </div>

                <div class="form-group">
                    <label for="notes">Notes (optional)</label>
                    <textarea
                        id="notes"
                        name="notes"
                        rows="3"
                        placeholder="Details of services, payment info..."
                    >{{ form_data.get('notes','') if form_data else '' }}</textarea>
                </div>

                <button type="submit" class="btn btn-primary btn-full">
                    Save Invoice
                </button>
            </form>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 Pet Clinic. All rights reserved.</p>
    </footer>
</body>
</html>
